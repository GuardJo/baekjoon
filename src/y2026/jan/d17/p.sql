CREATE TABLE CART_PRODUCTS
(
    ID      INT PRIMARY KEY,
    CART_ID INT,
    NAME    VARCHAR(255),
    PRICE   INT
);

INSERT INTO CART_PRODUCTS
VALUES (3728, 195, 'Ketchup', 1380);
INSERT INTO CART_PRODUCTS
VALUES (3729, 195, 'Pasta', 1980);
INSERT INTO CART_PRODUCTS
VALUES (5687, 301, 'Ice Cream', 3980);
INSERT INTO CART_PRODUCTS
VALUES (5695, 301, 'Frozen Food', 9980);
INSERT INTO CART_PRODUCTS
VALUES (5696, 301, 'Coffee', 24800);
INSERT INTO CART_PRODUCTS
VALUES (5697, 301, 'Coffee', 24800);

SELECT A.CART_ID, (A.TOTAL + IF(A.TOTAL < 50000, 3000, 0)) '결제액'
FROM (SELECT CP.CART_ID, SUM(CP.PRICE) TOTAL
      FROM CART_PRODUCTS CP
      GROUP BY CP.CART_ID) A;
